# ATLANT SERVICE 

–°–µ—Ä–≤–∏—Å–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏–Ω–æ–≤ –Ø–Ω–¥–µ–∫—Å.–î–∏—Ä–µ–∫—Ç–∞ –∏ —Å—á—ë—Ç—á–∏–∫–æ–≤ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ Telegram.

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –≤ Power BI, Looker Studio –∏ Google Sheets.

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –≤ Apache Airflow —á–µ—Ä–µ–∑ REST API.

- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ YAML –∏ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è DAG-–æ–≤.

##  üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- Telegram-–±–æ—Ç ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.
- Microservices ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –Ø.–î–∏—Ä–µ–∫—Ç–∞, –ú–µ—Ç—Ä–∏–∫–∏, –æ—Ç—á—ë—Ç–æ–≤, –∏ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DAG-–æ–≤.
- Apache Airflow ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–¥–∞—á.
- NATS + JetStream ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- PostgreSQL + pg\_probackup ‚Äî —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
- Alembic ‚Äî –º–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
- Docker + GitHub Actions ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ –∏ –¥–µ–ø–ª–æ—è.

##  üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç          | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                             |
| ------------------ |----------------------------------------|
| –Ø.–î–∏—Ä–µ–∫—Ç / –ú–µ—Ç—Ä–∏–∫–∞ | API-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Python               |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è        | Apache Airflow (REST API, DAG-—Ñ–∞–±—Ä–∏–∫–∞) |
| CI/CD              | GitHub Actions + DockerHub             |
| –°–æ–æ–±—â–µ–Ω–∏—è          | NATS, NATS JetStream                   |
| –•—Ä–∞–Ω–∏–ª–∏—â–µ          | PostgreSQL                             |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏         | Power BI, Looker Studio, Google Sheets |

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
| –ß—Ç–æ | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è |
|-----|--------------------|
| **Docker Engine** | 24.x |
| **Docker Compose** | v2 |

### 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/morarsv/srvc-atlant-bot.git
cd srvc-atlant-bot
```
### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–∑–µ—Ü –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```bash
cp .env.example .env
```
### 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ —Ç–æ–º–∞
```bash
mkdir -p \
  data            # –¥–∞–Ω–Ω—ã–µ Postgres
  pg_backups      # –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –±—ç–∫–∞–ø—ã (pg_probackup)
  logs            # –ª–æ–≥–∏ –±–æ—Ç–∞
  nats/data       # —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ JetStream
  nginx_logs      # –ª–æ–≥–∏ Nginx
```
### 5. –ó–∞–ø—É—Å–∫ —Å—Ç–µ–∫–∞
```bash
sudo docker compose up -d
```
Docker Compose —Ä–∞–∑–≤–µ—Ä–Ω—ë—Ç –ø—è—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤: 

| –°–µ—Ä–≤–∏—Å          | –û–±—Ä–∞–∑                   | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                                  |
|-----------------|-------------------------| --------------------------------------------------------------------------- |
| **postgres**    | `postgres:17-alpine`    | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `atlant`, health-check `pg_isready`                             |
| **nats**        | `nats:latest`           | –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π + JetStream, –∫–æ–Ω—Ñ–∏–≥ `server.conf`                          |
| **bot**         | `srvc-atlant-bot`       | Telegram-–±–æ—Ç; –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ health-check Postgres             |
| **oauth-token** | `oauth_token_ya:latest` | OAuth-service –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –Ø–Ω–¥–µ–∫—Å–∞                                 |
| **nginx**       | `nginx:1.26`            | Reverse-proxy (–ø–æ—Ä—Ç 80), —Å—Ç–∞—Ç–∏–∫–∞ –∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ `quart` –∏ `bot` |
